version: '3.8'\n\nservices:\n  frontend:\n    image: frontend:latest\n    ports:\n      - '8080:80'\n    environment:\n      - NODE_ENV=production\n    depends_on:\n      - backend\n    restart: always\n\n  backend:\n    image: backend:latest\n    ports:\n      - '5000:5000'\n    environment:\n      - DATABASE_URI=mongodb://mongo:27017/mydb\n    depends_on:\n      - mongo\n    restart: always\n\n  mongo:\n    image: mongo:latest\n    ports:\n      - '27017:27017'\n    volumes:\n      - mongo_data:/data/db\n    restart: always\n\n  monitoring:\n    image: monitoring:latest\n    ports:\n      - '3000:3000'\n    environment:\n      - MONITORING_ENV=production\n    depends_on:\n      - backend \n    restart: always\n\n  federated-learning:\n    image: federated-learning:latest\n    ports:\n      - '6000:6000'\n    environment:\n      - FL_SERVER_MODE=true\n      - FL_MODEL_PATH=/models\n    depends_on:\n      - backend\n      - mongo\n    healthcheck:\n      test: [ 'CMD', 'curl', '-f', 'http://localhost:6000/health' ]\n      interval: 30s\n      timeout: 10s\n      retries: 3\n    deploy:\n      resources:\n        limits:\n          cpus: '0.5'\n          memory: 512M\n\nvolumes:\n  mongo_data: